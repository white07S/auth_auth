# Runtime environment
ENVIRONMENT=development
APP_NAME=Auth BFF

# Azure AD / Microsoft Entra ID
AUTHORITY=https://login.microsoftonline.com/<tenant_id>
TENANT_ID=<tenant-guid>
CLIENT_ID=<application-client-id>
# Use either CLIENT_SECRET or the certificate pair below (but not both)
CLIENT_SECRET=<client-secret>
# CLIENT_CERTIFICATE_PATH=/secure/path/to/certificate.pem
# CLIENT_CERTIFICATE_PASSWORD=<optional-cert-password>

# OAuth redirect URI that Azure AD sends users back to
REDIRECT_URI=http://localhost:8000/auth/callback

# Graph scopes requested during interactive login
GRAPH_SCOPES=["openid","profile","email","offline_access","User.Read","GroupMember.Read.All"]

# RBAC mappings (inline JSON) or point RBAC_CONFIG_PATH at a YAML file
GROUPS_TO_ROLES={"<aad-group-id-admin>":["admin"],"<aad-group-id-authors>":["author"]}
ROLES_TO_PERMISSIONS={"admin":["*"],"author":["content:create","content:update","content:view"]}
# RBAC_CONFIG_PATH=./rbac.yaml

# Cookie & session settings
COOKIE_NAME=__Host_session
COOKIE_DOMAIN=
COOKIE_SECURE=false
COOKIE_SAMESITE=lax
COOKIE_PATH=/
COOKIE_MAX_AGE=1200
COOKIE_ABSOLUTE_MAX_AGE=28800

# CSRF protection
CSRF_COOKIE_NAME=XSRF-TOKEN
CSRF_HEADER_NAME=X-CSRF-Token
CSRF_TTL_SECONDS=7200

# Session/state tuning (seconds)
STATE_TTL_SECONDS=600
ROLE_CACHE_TTL_SECONDS=900
TOKEN_REFRESH_MARGIN_SECONDS=300

# Frontend redirects after auth events
POST_LOGIN_REDIRECT=/#/dashboard
POST_LOGOUT_REDIRECT=/#/logged-out

# SQLite database location
DATABASE_PATH=./.data/auth.db
DATABASE_POOL_SIZE=5

# Token encryption (must be a 32-byte urlsafe base64 string; generate with `python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"` )
TOKEN_ENCRYPTION_KEY=<fernet-key>

# Allowed origins for CORS
CORS_ALLOWED_ORIGINS=["http://localhost:3000"]

# Microsoft Graph client behaviour
GRAPH_REQUEST_TIMEOUT_SECONDS=5.0
GRAPH_PAGE_SIZE=100

# Logging / audit
AUDIT_LOG_ENABLED=true

